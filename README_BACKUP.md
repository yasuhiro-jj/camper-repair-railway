# キャンピングカー修理システム バックアップ・復元ガイド

## 概要
このシステムは完全バックアップ機能を提供し、プロジェクト全体のデータを安全にバックアップ・復元できます。

## ファイル構成
- `backup_script.bat` - 完全バックアップスクリプト
- `restore_script.bat` - 復元スクリプト
- `backup_exclude.txt` - バックアップ除外ファイルリスト
- `README_BACKUP.md` - このガイド

## バックアップ方法

### 1. 手動バックアップ
```cmd
# バックアップスクリプトを実行
backup_script.bat
```

### 2. 定期バックアップの設定
Windowsタスクスケジューラーを使用して定期実行を設定：

1. **タスクスケジューラーを開く**
   - Windows + R → `taskschd.msc`

2. **基本タスクの作成**
   - 「基本タスクの作成」をクリック
   - 名前: `キャンピングカー修理システム バックアップ`
   - トリガー: 毎週（日曜日など）
   - 操作: プログラムの開始
   - プログラム: `C:\path\to\backup_script.bat`

## 復元方法

### 1. 手動復元
```cmd
# 復元スクリプトを実行
restore_script.bat

# または特定のバックアップフォルダを指定
restore_script.bat backup_20241214_143022
```

### 2. 復元後の手順
1. 仮想環境の再作成
   ```cmd
   python -m venv venv
   venv\Scripts\activate
   ```

2. 依存関係のインストール
   ```cmd
   pip install -r requirements.txt
   ```

3. 環境変数の設定
   - `.env` ファイルを確認・編集
   - APIキーやデータベースIDを設定

4. システムのテスト
   ```cmd
   python repair_center_api.py
   ```

## バックアップ内容

### 含まれるファイル
- ✅ プロジェクトファイル全体
- ✅ 環境変数ファイル (`.env`, `env_example.txt`)
- ✅ 設定ファイル (`config.py`)
- ✅ ChromaDB（存在する場合）
- ✅ テキストファイル（知識ベース）
- ✅ Pythonスクリプト
- ✅ HTMLファイル
- ✅ CSS・JavaScriptファイル

### 除外されるファイル
- ❌ `__pycache__` フォルダ
- ❌ `.pyc` ファイル
- ❌ 仮想環境 (`venv`)
- ❌ Git フォルダ (`.git`)
- ❌ 既存のバックアップフォルダ
- ❌ 一時ファイル

## バックアップフォルダ構造
```
backup_20241214_143022/
├── project_files/          # プロジェクトファイル全体
│   ├── *.py               # Pythonスクリプト
│   ├── *.html             # HTMLファイル
│   ├── *.txt              # テキストファイル
│   ├── *.csv              # CSVファイル
│   └── ...
├── .env                   # 環境変数ファイル
├── env_example.txt        # 環境変数テンプレート
├── config.py              # 設定ファイル
├── chroma_db/             # ChromaDB（存在する場合）
└── backup_info.txt        # バックアップ情報
```

## トラブルシューティング

### よくある問題

#### 1. バックアップが失敗する
- **原因**: ディスク容量不足
- **解決**: 古いバックアップを削除して容量を確保

#### 2. 復元後にエラーが発生
- **原因**: 仮想環境が再作成されていない
- **解決**: 上記の復元後手順を実行

#### 3. 環境変数が正しく復元されない
- **原因**: `.env` ファイルが存在しない
- **解決**: `env_example.txt` をコピーして `.env` を作成

### ログファイル
バックアップ・復元の詳細ログは以下の場所に保存されます：
- `backup_info.txt` - バックアップ情報
- コンソール出力 - 実行ログ

## セキュリティ考慮事項

### 機密情報の保護
- APIキーやパスワードは `.env` ファイルに保存
- バックアップファイルは安全な場所に保管
- クラウドストレージにアップロードする場合は暗号化を検討

### アクセス制御
- バックアップフォルダのアクセス権限を制限
- 復元スクリプトの実行権限を管理

## 推奨事項

### 1. バックアップ頻度
- **開発中**: 毎日
- **本番環境**: 週1回以上
- **重要な変更前**: 即座に実行

### 2. 保存場所
- **ローカル**: 複数のバックアップを保存
- **クラウド**: Google Drive、OneDrive、Dropbox
- **外部ストレージ**: USBメモリ、外付けHDD

### 3. テスト
- 月1回は復元テストを実行
- バックアップファイルの整合性を確認

## サポート
問題が発生した場合は、以下の情報を含めてサポートに連絡してください：
- エラーメッセージ
- 実行したコマンド
- バックアップフォルダ名
- システム環境（OS、Pythonバージョンなど）
