#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«è²»ç”¨æƒ…å ±ã‚’å«ã‚€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
"""

import os
import sys
from data_access.notion_client import NotionClient

def create_sample_cost_data():
    """è²»ç”¨æƒ…å ±ã‚’å«ã‚€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ"""
    print("ğŸ”§ è²»ç”¨æƒ…å ±ã‚’å«ã‚€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...")
    
    try:
        notion_client = NotionClient()
        print("âœ… Notionã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–æˆåŠŸ")
        
        # ä¿®ç†ã‚±ãƒ¼ã‚¹DB IDã‚’å–å¾—
        case_db_id = notion_client._get_database_id("CASE_DB_ID", "NOTION_REPAIR_CASE_DB_ID")
        if not case_db_id:
            print("âŒ ä¿®ç†ã‚±ãƒ¼ã‚¹DB IDãŒå–å¾—ã§ãã¾ã›ã‚“")
            return
        
        print(f"ğŸ“Š ä¿®ç†ã‚±ãƒ¼ã‚¹DB ID: {case_db_id}")
        
        # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
        sample_cases = [
            {
                "ã‚±ãƒ¼ã‚¹ID": "ãƒ«ãƒ¼ãƒ•ãƒ™ãƒ³ãƒˆæ•…éšœ_001",
                "ã‚«ãƒ†ã‚´ãƒª": "ãƒ«ãƒ¼ãƒ•ãƒ™ãƒ³ãƒˆ",
                "ç—‡çŠ¶": "ãƒ«ãƒ¼ãƒ•ãƒ™ãƒ³ãƒˆãŒé–‹ã‹ãªã„ã€é–‰ã¾ã‚‰ãªã„ã€ç•°éŸ³ãŒã™ã‚‹",
                "è§£æ±ºæ–¹æ³•": "1. ãƒ¢ãƒ¼ã‚¿ãƒ¼ã®ç¢ºèª\n2. ã‚®ã‚¢ã®æ¸…æƒãƒ»æ½¤æ»‘\n3. å¿…è¦ã«å¿œã˜ã¦ãƒ¢ãƒ¼ã‚¿ãƒ¼äº¤æ›",
                "è²»ç”¨ç›®å®‰": "è¨ºæ–­æ–™: 3,000å††\nãƒ¢ãƒ¼ã‚¿ãƒ¼äº¤æ›: 15,000å††ã€œ25,000å††\nã‚®ã‚¢ä¿®ç†: 5,000å††ã€œ8,000å††"
            },
            {
                "ã‚±ãƒ¼ã‚¹ID": "ãƒãƒƒãƒ†ãƒªãƒ¼æ•…éšœ_001", 
                "ã‚«ãƒ†ã‚´ãƒª": "ãƒãƒƒãƒ†ãƒªãƒ¼",
                "ç—‡çŠ¶": "ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‹ã‹ã‚‰ãªã„ã€é›»åœ§ãŒä½ã„ã€å……é›»ã§ããªã„",
                "è§£æ±ºæ–¹æ³•": "1. ãƒãƒƒãƒ†ãƒªãƒ¼é›»åœ§æ¸¬å®š\n2. ç«¯å­ã®æ¸…æƒ\n3. ãƒãƒƒãƒ†ãƒªãƒ¼äº¤æ›",
                "è²»ç”¨ç›®å®‰": "è¨ºæ–­æ–™: 2,000å††\nãƒãƒƒãƒ†ãƒªãƒ¼äº¤æ›: 15,000å††ã€œ35,000å††\nç«¯å­æ¸…æƒ: 3,000å††"
            },
            {
                "ã‚±ãƒ¼ã‚¹ID": "ã‚¨ã‚¢ã‚³ãƒ³æ•…éšœ_001",
                "ã‚«ãƒ†ã‚´ãƒª": "ã‚¨ã‚¢ã‚³ãƒ³", 
                "ç—‡çŠ¶": "å†·æˆ¿ãŒåŠ¹ã‹ãªã„ã€æš–æˆ¿ãŒåŠ¹ã‹ãªã„ã€ç•°éŸ³ãŒã™ã‚‹",
                "è§£æ±ºæ–¹æ³•": "1. ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¸…æƒ\n2. å†·åª’ã‚¬ã‚¹ç¢ºèª\n3. ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚µãƒ¼ç‚¹æ¤œ",
                "è²»ç”¨ç›®å®‰": "è¨ºæ–­æ–™: 5,000å††\nå†·åª’ã‚¬ã‚¹è£œå……: 8,000å††ã€œ12,000å††\nã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚µãƒ¼äº¤æ›: 50,000å††ã€œ80,000å††"
            }
        ]
        
        print(f"ğŸ“ {len(sample_cases)}ä»¶ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...")
        
        for i, case_data in enumerate(sample_cases):
            try:
                # Notionãƒšãƒ¼ã‚¸ã‚’ä½œæˆ
                page_data = {
                    "parent": {"database_id": case_db_id},
                    "properties": {
                        "ã‚±ãƒ¼ã‚¹ID": {
                            "title": [
                                {
                                    "text": {
                                        "content": case_data["ã‚±ãƒ¼ã‚¹ID"]
                                    }
                                }
                            ]
                        },
                        "ã‚«ãƒ†ã‚´ãƒª": {
                            "rich_text": [
                                {
                                    "text": {
                                        "content": case_data["ã‚«ãƒ†ã‚´ãƒª"]
                                    }
                                }
                            ]
                        },
                        "ç—‡çŠ¶": {
                            "rich_text": [
                                {
                                    "text": {
                                        "content": case_data["ç—‡çŠ¶"]
                                    }
                                }
                            ]
                        },
                        "è§£æ±ºæ–¹æ³•": {
                            "rich_text": [
                                {
                                    "text": {
                                        "content": case_data["è§£æ±ºæ–¹æ³•"]
                                    }
                                }
                            ]
                        },
                        "è²»ç”¨ç›®å®‰": {
                            "rich_text": [
                                {
                                    "text": {
                                        "content": case_data["è²»ç”¨ç›®å®‰"]
                                    }
                                }
                            ]
                        }
                    }
                }
                
                # ãƒšãƒ¼ã‚¸ã‚’ä½œæˆ
                response = notion_client.client.pages.create(**page_data)
                print(f"âœ… ã‚±ãƒ¼ã‚¹ {i+1} ä½œæˆæˆåŠŸ: {case_data['ã‚±ãƒ¼ã‚¹ID']}")
                
            except Exception as e:
                print(f"âŒ ã‚±ãƒ¼ã‚¹ {i+1} ä½œæˆå¤±æ•—: {e}")
                # æ—¢å­˜ã®ãƒšãƒ¼ã‚¸ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
                if "already exists" in str(e).lower():
                    print(f"  â†’ æ—¢å­˜ã®ãƒšãƒ¼ã‚¸ã®ãŸã‚ã‚¹ã‚­ãƒƒãƒ—")
                else:
                    import traceback
                    traceback.print_exc()
        
        print("\nâœ… ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ä½œæˆå®Œäº†")
        print("ğŸ” ä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã™ã‚‹ã«ã¯: python check_notion_cost_data.py")
        
    except Exception as e:
        print(f"âŒ ã‚¨ãƒ©ãƒ¼: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    create_sample_cost_data()
